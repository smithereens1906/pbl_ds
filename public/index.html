<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Submit Résumé</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body class="bg-dark">
<div class="container py-5">
  <h2 class="mb-4 gradient-text">Résumé Management System</h2>

  <!-- submit form -->
  <form id="submitForm" class="glass-card p-4 mb-5">
    <h4 class="mb-3 text-white">Submit your résumé</h4>
    <div class="row g-3">
      <div class="col-md-6">
        <label class="form-label text-light">Name</label>
        <input name="name" class="form-control rounded-pill" required>
      </div>
      <div class="col-md-6">
        <label class="form-label text-light">Email</label>
        <input type="email" name="email" class="form-control rounded-pill" required>
      </div>
      <div class="col-md-6">
        <label class="form-label text-light">Phone</label>
        <input name="phone" class="form-control rounded-pill" required>
      </div>
      <div class="col-md-6">
        <label class="form-label text-light">Qualification</label>
        <select name="qualification" class="form-select rounded-pill" required>
          <option>PhD</option><option>Masters</option><option>Bachelors</option><option>Other</option>
        </select>
      </div>
      <div class="col-12">
        <label class="form-label text-light">Skills (comma separated)</label>
        <input name="skills" class="form-control rounded-pill" placeholder="e.g. C, Python, SQL">
      </div>
      <div class="col-md-6">
        <label class="form-label text-light">Experience (years)</label>
        <input type="number" min="0" name="experience" class="form-control rounded-pill" required>
      </div>
      <div class="col-12">
        <button class="btn btn-glow rounded-pill px-4">Submit</button>
      </div>
    </div>
  </form>

  <!-- check status -->
  <div class="glass-card p-4">
    <h4 class="text-white mb-3">Check your status</h4>
    <div class="input-group mb-3">
      <input id="statusName" class="form-control rounded-pill" placeholder="Enter your name">
      <button id="checkBtn" class="btn btn-glow rounded-pill">Check</button>
    </div>
    <ul id="statusList" class="list-group list-group-flush"></ul>
  </div>

  <div class="text-center mt-4">
    <a href="admin.html" class="btn btn-outline-light rounded-pill px-4">Admin Panel</a>
  </div>
</div>

<script>
document.getElementById('submitForm').addEventListener('submit', async e=>{
  e.preventDefault();
  const data = Object.fromEntries(new FormData(e.target));
  const res = await fetch('/api/resumes',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(data)});
  const json = await res.json();
  alert(json.error||`Submitted! Your computed score is ${json.score}`);
  e.target.reset();
});

document.getElementById('checkBtn').addEventListener('click', async ()=>{
  const name = document.getElementById('statusName').value.trim();
  if(!name)return;
  const res = await fetch('/api/status?name='+encodeURIComponent(name));
  const arr = await res.json();
  const ul = document.getElementById('statusList'); ul.innerHTML='';
  if(!arr.length) return ul.innerHTML='<li class="list-group-item glass-dark">No match</li>';
  arr.forEach(r=>{
    const st = r.status===1?'<span class="badge bg-cyan">SELECTED</span>':
               r.status===2?'<span class="badge bg-danger">REJECTED</span>':
               '<span class="badge bg-secondary">Pending</span>';
    ul.innerHTML+=`<li class="list-group-item glass-dark">${r.name} (score ${r.score}) ${st}</li>`;
  });
});
</script>
</body>
</html>